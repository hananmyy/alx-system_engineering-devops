#!/usr/bin/env bash
# Transfers a file to a remote server's home directory using SCP

# Validate the number of arguments
if [ "$#" -lt 4 ]; then
    echo "Usage: 0-transfer_file PATH_TO_FILE IP USERNAME PATH_TO_SSH_KEY"
    exit 1
elif [ ! -f "$1" ]; then
    echo "Error: File '$1' does not exist."
    exit 2
elif [ ! -f "$4" ]; then
    echo "Error: SSH key '$4' does not exist."
    exit 3
else
    FILE_PATH="$1"
    SERVER_IP="$2"
    USERNAME="$3"
    SSH_KEY="$4"

    scp -i "$SSH_KEY" -o StrictHostKeyChecking=no "$FILE_PATH" "${USERNAME}@${SERVER_IP}:~/"
    
    # Check if SCP succeeded
    if [ $? -eq 0 ]; then
        echo "File successfully transferred to ${USERNAME}@${SERVER_IP}:~/"
    else
        echo "SCP failed. Please verify the server IP, SSH key, and permissions."
        exit 4
    fi
fi